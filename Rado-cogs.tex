\section{Rado graph, with cogs}
In this section we work with the following setting:
\begin{itemize}
    \item 
    $\mathcal{L}_0$ is a (possibly infinite) relational language containing a binary symbol $=$;

    \item 
    $\mathcal{C}_0$ is a free amalgamation class of $\mathcal{L}_0$-structures
    where $=$ is interpreted as true equality, but every other $R \in \mathcal{L}_0$ is interpreted irreflexively.\footnote{We may assume irreflexivity with no loss of generality: see \cite[beginning of \S2.4]{SS20}.}

    \item 
    $\mathcal{L}$ consists of $\mathcal{L}_0$ together with a new binary symbol $<$;

    \item 
    $\mathcal{C}$ consists of $\mathcal{L}$-structures obtained from $\mathcal{C}_0$ by expanding with all possible linear orderings;

    \item 
    $\A_0$ and $\A$ are the respective Fraïssé limits of $\mathcal{C}_0$ and $\mathcal{C}$,
    where without loss of generality we assume $\A_0$ and $\A$ share the same domain so that $\Aut(\A_0) \supseteq \Aut(\A)$.
\end{itemize}

\begin{example}\label{ex:N-Q}
    Take $\mathcal{L}_0$ to consist of $=$ only and $\mathcal{C}_0$ to be all finite sets.
    Then $\A_0$ is isomorphic to the pure set $\N$, whereas $\A$ is isomorphic to $\Q$ with the usual order.
\end{example}

\begin{example}\label{ex:Rado-orderedRado}
    Let $\mathcal{L}_0$ consist of $=$ together with a single binary symbol $\sim$ 
    and let $\mathcal{C}_0$ consist of all finite undirected graphs not embedding the complete graph $K_n$,
    where $3 \leq n$ ($\leq \infty$).
    Then $\A_0$ is the $K_n$-free Henson graph (or the Rado graph when $n = \infty$), and $\A$ is its generically ordered counterpart.
    (Allowing $n = 2$ makes these degenerate to $\N$ and $\Q$ above).
\end{example}

Free amalgamation in $\mathcal{C}_0$ allows us to free atoms in $\A$ from undesired relations.
Let us make this more precise.
Given atoms $z_i, z_j \in Z \subseteq \A$, we say $z_i$ is \emph{related} to $z_j$ in $Z$ if $z_i, z_j$ appear together in some tuple $z_\bullet \in Z^*$ such that $\A \models R(a_\bullet)$ for some $R \in \mathcal{L}_0$ (since $z_i$ and $z_j$ are certainly related by $<$).
% Note: unrelated necessarily means non-equal.
Otherwise we say $z_i$ is \emph{unrelated} to $z_j$ in $Z$
--- notice it is still possible that $z_i$ becomes related to $z_j$ in some bigger $Z$ unless every relation in $\mathcal{L}_0$ is at most binary.
\begin{lemma}\label{lem:free-fresh}
    Let $X, Y, \{z\} \subseteq \A$ be disjoint and finite.
    Then there is some automorphism $\tau \in \Aut(\A)$ such that
    \begin{enumerate}
        \item $\tau$ fixes every $x \in X$;
        \item $\tau(z)$ is unrelated to any $y \in Y$ and to $z$ in $X \cup Y \cup \{z, \tau(z)\}$;
        \item $\tau(z) > z$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    In $\A_0$, form the free amalgam
% https://q.uiver.app/#q=WzAsNCxbMCwxLCJYIl0sWzEsMiwiWCBcXGN1cCBcXHt6XFx9Il0sWzEsMCwiWCBcXGN1cCBZIFxcY3VwIFxce3pcXH0iXSxbMiwxLCJYIFxcY3VwIFkgXFxjdXAgXFx7eiwgeidcXH0iXSxbMCwxLCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dLFswLDIsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzEsMywieCBcXGluIFggXFxtYXBzdG8geCwgeiBcXG1hcHN0byB6JyIsMSx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn0sImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dLFsyLDMsIlxcc3Vic2V0ZXEiLDEseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9LCJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XV0=
\[\begin{tikzcd}[cramped]
	& {X \cup Y \cup \{z\}} \\
	X && {X \cup Y \cup \{z, z'\}} \\
	& {X \cup \{z\}}
	\arrow["\subseteq"{description}, dashed, hook, from=1-2, to=2-3]
	\arrow[hook, from=2-1, to=1-2]
	\arrow[hook, from=2-1, to=3-2]
	\arrow["{x \in X \mapsto x, z \mapsto z'}"{description}, dashed, hook, from=3-2, to=2-3]
\end{tikzcd}\]
    so that no element of $Y \cup \{z\}$ is related to $z'$ in $X \cup Y \cup \{z, z'\}$.
    Now we make $X \cup Y \cup \{z, z'\}$ an $\mathcal{L}$-structure: 
    inherit the order on $X \cup Y \cup \{z\}$ from $\A$,
    and declare that $z < z'$ as well as $z' < a$ if $a$, the next element of $X \cup Y$ larger than $z$, exists at all.
    Observe that \[
        x \in X \mapsto x, z \mapsto z'
    \] is still an embedding in presence of the order.
    By homogeneity, we may embed $X \cup Y \cup \{z, z'\}$ into $\A$ via some $f$ which is the identity on $X \cup Y \cup \{z\}$;
    again by homogeneity, we may extend the embedding \[ 
        f(x) = x \in X \mapsto f(x), f(z) \mapsto f(z')
    \] to some automorphism $\tau$ which makes 1), 2), and 3) true.
\end{proof}

On the other hand, an $\mathcal{L}$-structure fails to embed into $\A$ precisely when it embeds some forbidden structure, in which every two distinct elements are related:
\begin{lemma}\label{lem:free-forb}
    Let $\mathcal{F}_0$ consist of minimal (with respect to $\subseteq$) $\mathcal{L}_0$-structures which do not appear in $\mathcal{C}_0$.
    Then
    \begin{enumerate}
        \item $\mathcal{C}_0$ consists of every $\mathcal{L}_0$-structure that does not embed any $F \in \mathcal{F}_0$.
        \item $\mathcal{C}$ consists of every $\mathcal{L}$-structure whose $\mathcal{L}_0$-reduct does not embed any $F \in \mathcal{F}_0$.
        \item In any $F \in \mathcal{F}_0$, every two distinct elements $x, y \in F$ are related by some $R \in \mathcal{L}_0$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    As $\mathcal{C}_0$ is closed under substructures, its complement is closed under superstructures and thus is 
    --- since there are no infinite strictly descending chain of embedded substructures 
    --- determined by its minimal structures.
    2) follows because an $\mathcal{L}$-structure is in $\mathcal{C}$ precisely when its $\mathcal{L}_0$-reduct is in $\mathcal{C}_0$.
    For 3), notice that $F \setminus \{x\}$, $F \setminus \{y\}$ are in $\mathcal{C}_0$ by minimality; 
    therefore so is their free amalgam over $F \setminus \{x, y\}$, which then cannot agree with $F$.
\end{proof}

In what follows, we will juggle with Lemma~\ref{lem:free-fresh} just enough so that we avoid the forbidden structures described in Lemma~\ref{lem:free-forb}.
A main result will be:
\begin{theorem}\label{thm:free-bin-oligo}
    Assume each $R \in \mathcal{L}_0$ has arity at most two.
    Then $\A$ is $\FF$-oligomorphic for any field $\FF$ even with finitely many constants fixed, provided that $\A$ is oligomorphic (for instance if $\mathcal{L}_0$ is finite).
\end{theorem}
And a corollary will be that $\A$ from Examples~\ref{ex:N-Q} and \ref{ex:Rado-orderedRado} is $\FF$-oligomorphic;
as is its reduct $\A_0$.

\subsection{Two reductions: orbits and projections}

To start with, let us view $\A^d$ as $\A^{\{1, \dots, d\}}$ and more generally consider $\A^I$ for a finite indexing set $I \subseteq \N$.
Fix a finite support $S \subseteq \A$.
If $\A$ is oligomorphic, the tuples in $\A^I$ split into finitely many $\Aut(\A)_{(S)}$-equivariant orbits.
Let $\mathcal{O} = \Aut(\A)_{(S)} \cdot o_\bullet$ be one such orbit.
We shall call $\mathcal{O}$ \emph{($S$-)rigid} if $o_i \not\in S$ and if $o_i < o_j$ whenever $i < j$.
By removing the entries in $o_\bullet$ that repeat or come from $S$ and reordering the rest, we can always find an $\Aut(\A)_{(S)}$-equivariant bijection to an $S$-rigid orbit.
An easy observation is that we may focus on a single rigid orbit at a time:
\begin{proposition}\label{prop:reduction-to-one-orbit}
    The following are equivalent:
    \begin{enumerate}
        \item For $d = 0, 1, 2, \dots$ and any finite $S \subseteq \A$, chains of $\Aut(\A)_{(S)}$-equivariant subspaces in $\Lin_\FF \A^d$ are bounded in length;
        \item $\A$ is oligomorphic, and $\Lin_\FF \mathcal{O}$ has fintie length for any rigid orbit $\mathcal{O}$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    We have $\len(\Lin_\FF(\biguplus_i \mathcal{O}_i)) = \len(\bigoplus_i \Lin_\FF \mathcal{O}_i) = \sum_i \len(\Lin_\FF \mathcal{O}_i)$.
\end{proof}

So fix an rigid orbit $\mathcal{O} = \Aut(\A)_{(S)} \cdot o_\bullet \subseteq \A^I$.
From here we take an inductive approach.
By $o |^J _\bullet$ we mean the restriction of $o_\bullet : I \to \A$ to $J \subseteq I$;
we will often write $o |^{-i} _\bullet$ instead of $o |^{ I \setminus \{i\} }_\bullet$.
Note the image $\mathcal{O}|^I$ of $\mathcal{O}$ under this projection agrees with $\Aut(\A)_{(S)} \cdot o |^J _\bullet$ and is still rigid.

To anticipate more general statements later, Let $\EE$ be a finite-dimensional $\FF$-vector space --- for instance, $\FF$ itself.
Things become more interesting when we lift $(-)|^J$ to a linear $\Aut(\A)_{(S)}$-equivariant map
\begin{align*}
    (-)|^J : \Lin_\EE \mathcal{O} &\to \Lin_\EE \mathcal{O}|^J \\
    v &\mapsto v|^J.
\end{align*}
Many cancellations can occur under $(-)|^J$; 
the \emph{projection kernel} is the $\Aut(\A)_{(S)}$-equivariant subspace
\[
    \Ker_\EE \mathcal{O} = \bigcap_{i \in I} \ker{ (-)|^{-i} }
\]
of $\Lin_\EE \mathcal{O}$.

\begin{proposition}\label{prop:reduction-to-kernel}
    The following are equivalent:
    \begin{enumerate}
        \item $\Lin_\FF \mathcal{O}$ has finite length for every rigid orbit $\mathcal{O}$;
        \item $\Ker_\FF \mathcal{O}$ has finite length for every rigid orbit $\mathcal{O}$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    That 1) implies 2) is clear as $\Ker_\FF \mathcal{O} \subseteq \Lin_\FF \mathcal{O}$.
    
    To prove the other implication, assume 2) and let $\mathcal{O} \subseteq \A^I$.
    We proceed by induction on $|I|$.
    If $I = \emptyset$, then $\mathcal{O}$ must be the entire singleton $\A^\emptyset = \{ () \}$; 
    as $\Lin_\FF \mathcal{O}$ has no nontrivial subspaces (let alone finitely supported ones), it has length $1$.
    Now if $|I| \geq 1$, assemble all $|I|$ projection maps into a single map
    \begin{align*}
        \Lin_\FF \mathcal{O} &\to \bigoplus_{i \in I} \mathcal{O}|^{-i} \\
        v &\mapsto ( v|^{-i} )_{i \in I}
    \end{align*}
    whose kernel is precisely $\Ker_\FF \mathcal{O}$.
    We have
    \[
        \len( \Lin_\FF \mathcal{O} ) - \len( \Ker_\FF \mathcal{O} )
        \leq \sum_{i \in I} \len( \Lin_\FF \mathcal{O}|^{-i} )
    \]
    which shows that $\len( \Lin_\FF \mathcal{O} )$ is finite from the assumptions.
\end{proof}

We call a vector from the projection kernel \emph{balanced}.
As we will see in the next subsection, cogs are a prominent example.

\subsection{Cogs}
\begin{definition}
    Let $\mathcal{O} = \Aut(\A)_{(S)} \cdot o_\bullet \subseteq \A^I$ be an $S$-rigid orbit. 
    An \emph{$\mathcal{O}$-cog duo} $a_\bullet \parallel b_\bullet$ consists of $2 \cdot |I|$ atoms in $\A$ with the following $\mathcal{L}$-structure on $\{a_i, b_i \mid i \in I\} \cup S$:
    \begin{enumerate}
        \item 
        $a_{i_1} < b_{i_1} < a_{i_2} < b_{i_2} < \dots < a_{i_d} < b_{i_d}$ where $I$ consists of the indices $i_1 < i_2 < \dots < i_d$;
        
        \item 
        $a_i , b_i < s$ if and only if $o_i < s$;        

        \item 
        any relation in $\mathcal{L}_0$ (in particular $=$) holds for a tuple $c_\bullet$ with entries in $a_I \cup b_I \cup S$ if and only if it holds for $c_\bullet$ with each entry equal to $a_i, b_i$ replaced by $o_i$.
    \end{enumerate}
\end{definition}
Three remarks are in order.
First, each $a_i$ is unrelated to its counterpart $b_i$ in $a_I \cup b_I \cup S$.
Second, given any $J \subseteq I$, the combined tuple $a|^J_\bullet ; b|^{I \setminus J}_\bullet$ lies in $\mathcal{O}$ by homogeneity:
observe
\begin{align*}
    a_j &\mapsto o_j, j \in J ; \\
    b_i &\mapsto o_i, i \in I \setminus J ; \\
    s &\mapsto s, s \in S
\end{align*}
defines an embedding.
Third, by homogeneity still, any two cog duos $a_\bullet \parallel b_\bullet$ and $a'_\bullet \parallel b'_\bullet$ belong to the same $\Aut(\A)_{(S)}$-equivariant orbit.

\begin{definition}
    Given $\lambda \in \EE$ and an $\mathcal{O}$-cog duo $a_\bullet \parallel b_\bullet$, the corresponding \emph{$\mathcal{O}$-cog} with coefficient $\lambda$ is the vector
    \[
        \lambda \cdot a_\bullet \between b_\bullet =
        \sum_{J \subseteq I} (-1)^{|J|} \lambda \cdot  a|^{I \setminus J}_\bullet ; b^{J}_\bullet
    \]
    in $\Lin_\EE \mathcal{O}$.
    The linear span of all $\mathcal{O}$-cogs with coefficients from $\EE$ is denoted by $\Cog_\EE \mathcal{O}$.
\end{definition}
As remarked above, given any two $\mathcal{O}$-cog duos there is some $\pi \in \Aut(\A)_{(S)}$ such that $\pi \cdot (a_\bullet \parallel b_\bullet) = a'_\bullet \parallel b'_\bullet$ and thus $\pi \cdot (\lambda \cdot a_\bullet \between b_\bullet) = \lambda \cdot a'_\bullet \between b'_\bullet$.
Hence $\Cog_\EE \mathcal{O}$ is an $\Aut(\A)_{(S)}$-equivariant subspace of $\Lin_\EE \mathcal{O}$ and it is generated by cogs based on a single duo.


\begin{proposition}\label{prop:cogs-are-balanced}
    $\Cog_\EE \mathcal{O}$ is contained in $\Ker_\EE \mathcal{O}$.
\end{proposition}
\begin{proof}
    Let $\mathcal{O} \subseteq \A^I$, let $a_\bullet \parallel b_\bullet$ be an $\mathcal{O}$-cog duo, and let $i \in I$.
    The subsets of $I$ come in pairs of $J$ and $J \cup \{i\}$, where $J$ is a subset of $I \setminus \{i\}$.
    The two tuples $a|^{J}_\bullet ; b|^{I \setminus J}_\bullet$ and $a|^{J \cup \{i\}}_\bullet ; b|^{I \setminus (J \cup \{i\})}_\bullet$ differ only on the $i$th entry.
    But this difference gets erased under $(-)|^{-i}$, so the two corresponding terms in $\lambda \cdot a_\bullet \between b_\bullet$ will cancel out and hence $( \lambda \cdot a_\bullet \between b_\bullet )|^{-i} = 0$ overall.
\end{proof}

In fact, cogs arise anywhere.
\begin{lemma}\label{lem:cog-fresh-single}
    Suppose $a_\bullet \parallel b_\bullet$ is an $\mathcal{O}$-cog duo, where $\mathcal{O} \subseteq \A^I$ is $S$-rigid.
    Given $z \in S$, 
    \begin{itemize}
        \item write $S' = S \setminus \{z\}$;
        \item let $j \not\in I$ be such that $\mathcal{O}' = \Aut(\A)_{(S')} \cdot (a_\bullet ; z) \subseteq \A^{I \cup \{j\}}$ is rigid,
        \item let $X \subseteq \A$ be a finite set containing $\{a_i, b_i \mid i \in I\} \cup S'$ but not $z$;
        \item let $Y \subseteq \A$ be any finite set disjoint from $X \cup \{z\}$;
    \end{itemize}
    then the $\tau \in \Aut(\A)_{(X)}$ afforded by Lemma~\ref{lem:free-fresh} gives us an $\mathcal{O}'$-cog duo $(a_\bullet ; z) \parallel (b_\bullet ; \tau \cdot z)$.
\end{lemma}
\begin{proof}
    To start with, notice that we have the required order relations with $z$ and $\tau(z)$.
    Now let $R \in \mathcal{L}_0$ and let $c_\bullet$ be a tuple with entries in $a_{I \cup \{j\}} \cup b_{I \cup \{j\}} \cup S' = a_I \cup b_I \cup S \cup \{\tau \cdot z\}$;
    we want to show that \begin{equation}\label{eq:cog-building-relation}
        \A \models R(c_\bullet) \text{ if and only if } 
        \A \models R(d_\bullet), \tag{\P}
    \end{equation} 
    where $d_\bullet$ is obtained from $c_\bullet$ by replacing every $b_i$ with $a_i$ and $\tau \cdot z$ with $z$.
    We split into three cases.
    \begin{enumerate}
        \item 
        Suppose $z$ and $\tau \cdot z$ both appear in $c_\bullet$. 
        Then $\A \not\models R(c_\bullet)$ because $\tau \cdot z$ is unrelated to $z$ by design, 
        and $\A \not\models R(d_\bullet)$ because $R$ is irreflexive and $z$ appears twice.
        
        \item 
        So if $z$ appears in $c_\bullet$, we may assume that $\tau \cdot z$ does not --- that is, $c_\bullet$ has entries in $a_I \cup b_I \cup S$.
        In this case \eqref{eq:cog-building-relation} follows from the assumption that $a_\bullet \parallel b_\bullet$ is a cog duo in $\mathcal{O} = \Aut(\A)_{(S)} \cdot a_\bullet$.

        \item
        Finally, suppose that $\tau \cdot z$ appears in $c_\bullet$ but not $z$.
        Then only $z$ appears in $\tau^{-1} \cdot c_\bullet$, and $d_\bullet$ is obtained by replacing every $b_i$ with $a_i$ in $\tau^{-1} \cdot c_\bullet$.
        But $\A \models R(c_\bullet)$ if and only if $\A \models R(\tau^{-1} \cdot c_\bullet)$, and now \eqref{eq:cog-building-relation} holds as we discussed for the case above. 
        \qedhere
    \end{enumerate}
\end{proof}

Starting from an empty cog duo, we may apply the previous lemma inductively.
\begin{proposition}\label{prop:cog-fresh-full}
    Let $\mathcal{O} \subseteq \A^I$ be an $S$-rigid orbit.
    Then for any $a_\bullet \in \mathcal{O}$, there is: 
    \begin{enumerate}
        \item some $b_\bullet \in \mathcal{O}$ such that $a_\bullet \parallel b_\bullet$ is an $\mathcal{O}$-cog duo; and
        \item for each $i \in I$, some $\pi_i \in \Aut(\A)_{(S \cup \{a_j, b_j \mid j \in I, j \neq i \})}$ sending $a_i \mapsto b_i$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    Enumerate the indices of $I$ as $i_1, \dots, i_d$.
    Suppose that we have found $b_{i_1}, \dots, b_{i_k}$ such that 
    \[
        a|^{\{i_1, \dots, i_k\}}_\bullet \parallel (i_1 \mapsto b_{i_1}, \dots, i_k \mapsto b_{i_k})
    \] 
    is a cog duo in $\mathcal{O}_k = \Aut(\A)_{(S \cup \{a_{i_{k+1}}, \dots, a_{i_d}\})} \cdot a|^{\{i_1, \dots, i_k\}}_\bullet$ 
    --- note that $() \parallel ()$ is certainly a cog duo in $\mathcal{O}_0$ at the start.
    If $k < d$, with $z = a_{i_{k+1}}$, $X = \{a_{i_1}, b_{i_1}, \dots, a_{i_k}, b_{i_k}\} \cup S \cup \{a_{i_{k+2}}, \dots, a_{i_d}\}$, and $Y = \emptyset$, 
    a straightforward application of Lemma~\ref{lem:cog-fresh-single} yields an atom $b_{i_{k+1}}$ that makes
    \[
        a|^{\{i_1, \dots, i_k, i_{k+1}\}}_\bullet \parallel (i_1 \mapsto b_{i_1}, \dots, i_k \mapsto b_{i_k}, i_{k+1} \mapsto b_{i_{k+1}})
    \] a cog duo in $\mathcal{O}_{k+1}$.
    We thus obtain the desired cog duo in $\mathcal{O}_d = \mathcal{O}$ as we reach $k = d$.
    The automorphisms $\pi_{i_k}$ now come directly from homogeneity and the definition of an $\mathcal{O}$-cog duo: 
    the map
    \begin{align*}
        a_{i_1} \mapsto a_{i_1}, \dots,{} &a_{i_k} \mapsto b_{i_k}, \dots, a_{i_d} \mapsto a_{i_d} \\
        b_{i_1} \mapsto b_{i_1}, \dots,{} &\phantom{a_{i_k} \mapsto b_{i_k}}, \dots, b_{i_d} \mapsto b_{i_d}, s \in S \mapsto s
    \end{align*}
    is an embedding.
\end{proof}

The result below substantiates the slogan that cogs are found everywhere. 
\begin{theorem} \label{thm:cogs-arise-everywhere}
    Any $\Aut(\A)_{(S)}$-equivariant subspace $V$ of $\Lin_\EE \mathcal{O}$ contains $\Cog_{\EE(V)} \mathcal{O}$,
    where $\mathcal{O} \subseteq \A^I$ is $S$-rigid and $\EE(V)$ is the subspace spanned by $\{ v(a_\bullet) \mid v \in V, a_\bullet \in \mathcal{O} \}$ of $\EE$.
\end{theorem}
\begin{proof}
    Pick any $v \in V$ and $a_\bullet \in \mathcal{O}$;
    it is enough to show that $V$ contains $v(a_\bullet) \cdot a_\bullet \between b_\bullet$ for some $\mathcal{O}$-cog duo $a_\bullet \parallel b_\bullet$.
    Actually, write 
    \[
        S' = S \cup \{c_i \mid v(c_\bullet) \neq 0, i \in I\} \setminus \{a_i \mid i \in I\} \supseteq S
    \]
    and put $\mathcal{O}' = \Aut(\A)_{(S')} \cdot a_\bullet \subseteq \mathcal{O}$ --- then $\mathcal{O}'$ is $S'$-rigid.
    By Proposition~\ref{prop:cog-fresh-full}, we can find $b_\bullet \in \mathcal{O}'$ such that $a_\bullet \parallel b_\bullet$ is a cog duo in $\mathcal{O}'$ and \emph{a fortiori} a cog duo in $\mathcal{O}$.
    Also take the automorphisms $\pi_{i_1}, \dots, \pi_{i_d}$ from there, where $i_1, \dots, i_d$ enumerate $I$.
    Now define $v_0 = v$ and \[
        v_k = v_{k-1} - \pi_{i_k} \cdot v_{k-1}.
    \]
    We can check inductively that for $k = 0, 1, \dots, d$, 
    with $\mathcal{O}_k = \{ c_\bullet \mid v(c_\bullet) \neq 0, \{c_{i_1}, \dots, c_{i_k}, \dots, c_{i_d}\} \supseteq \{a_{i_1}, \dots, a_{i_k}\} \}$ we have
    \[
        v_k = \sum_{c_\bullet \in \mathcal{O}_k} \sum_{J \subseteq \{i_1, \dots, i_k\}} (-1)^{|J|} v(c_\bullet) \cdot c|^J_\bullet ; b|^{I \setminus J}_\bullet.
    \]
    But $\{c_{i_1}, \dots, c_{i_d}\} \supseteq \{a_{i_1}, \dots, a_{i_d}\}$ means that $c_\bullet = a_\bullet$, so at the end $v_d$ is the desired $\mathcal{O}$-cog.
\end{proof}

\begin{corollary}
    $\Cog_\FF \mathcal{O}$ has length $1$.
\end{corollary}
\begin{proof}
    Let $V \subseteq \Cog_\FF \mathcal{O}$ be a non-zero $\Aut(\A)_{(S)}$-equivariant subspace.
    Then $\{0\} \subsetneq \EE(V) \subseteq \EE = \FF$ so $\EE$ must be the entire field $\FF$, and by above $V$ must be $\Cog_\FF \mathcal{O}$ itself.
\end{proof}

In light of Propositions~\ref{prop:reduction-to-one-orbit} and \ref{prop:reduction-to-kernel}, we will be able to prove the finite length property for an oligomorphic structure with free amalgamation over any field and support if we know $\Ker_\FF \mathcal{O} = \Cog_\FF \mathcal{O}$.
Let us now attempt to show that.

\subsection{Subvectors}
This is a good time to recall a view we have tacitly taken:
with $\mathcal{O}$ as a standard basis, a vector $v \in \Lin_\EE \mathcal{O}$ is just a finite set of pairs in $\EE \times \mathcal{O}$.
A \emph{subvector} of $v$ is a subset of these pairs.

Now suppose as usual that $\mathcal{O} \subseteq \A^I$ is $S$-rigid.
Given $i \in I$ and $a = a_i \in \A$ for some $a_\bullet \in \mathcal{O}$, 
we write \[
    \mathcal{O}^{i:a} = \{b_\bullet \in \mathcal{O} \mid b_i = a\};
\]
this is an $\Aut(\A)_{(S \cup \{a\})}$-orbit, and its projection $\mathcal{O}^{i:a} |^{-i} = \Aut(\A)_{(S \cup \{a\})} \cdot a|^{-i}_\bullet$ is rigid.
For a vector $v \in \Lin_\EE \mathcal{O}$, by
\[
    v^{i:a} \in \Lin_\EE \mathcal{O}^{i:a}
\]
we mean the subvector consisting of all pairs in $\EE \times \mathcal{O}^{i:a}$.

\begin{lemma}\label{lem:balanced-projected-subvector}
    Let $v \in \Lin_\EE \mathcal{O}$ be balanced. 
    Then any projected subvector $v^{i:a}|^{-i} \in \Lin_\EE \mathcal{O}^{i:a}|^{-i}$ is also balanced.
\end{lemma}
\begin{proof}
    Let $j \in I \setminus \{i\}$. 
    By assumption we have \[
        0 = v|^{-j} = \sum_a v^{i:a}|^{-j}
    \] in $\Lin_\EE \A^{I \setminus \{j\}}$,
    so by looking at $i$th entries we see that each $v^{i:a}|^{-j}$ must be the zero vector.
    Hence so is $v^{i:a}|^{-j}|^{-i} = v^{i:a}|^{-i}|^{-j}$,
    which shows that $v^{i:a}|^{-i}$ is in the projection kernel.
\end{proof}

So we can try to prove $\Ker_\EE \mathcal{O} \subseteq \Cog_\EE \mathcal{O}$ for any rigid $\mathcal{O} \subseteq \A^I$ by inducting on $|I|$;
we just need to reassemble the various cogs in $\mathcal{O}^{i:a}|^{-i}$ back into $\mathcal{O}$-cogs.
Unfortunately we were only able to do so under the hypothesis that $\mathcal{L}_0$ is an at most binary language, 
which we henceforth assume.

\subsection{Special case: unobstructed vectors}
We will begin by showing any $v \in \Ker_\EE \mathcal{O}$ lies in $\Cog_\EE \mathcal{O}$ provided that $v$ satisfies an additional condition which, 
as we will explain in the subsection, may be assumed without loss of generality. 
We motivate and introduce this condition now. 

Consider the atoms in the tuples 
\[
    \mathcal{O}(v) = \{ b_\bullet \in \mathcal{O} \mid v(b_\bullet) \neq 0 \}.
\]
that appear in a vector $v \in \Lin_\EE \mathcal{O}$, with $\mathcal{O}$ being $S$-rigid.
Take $a = b_i$ to be one such atom,
and let $R_1, R_2 \in \mathcal{L}_0$ be unary and binary respectively.
Then whether $R_1(a)$, $R_2(a, s)$, $R_2(s, a)$ hold in $\A$ given $s \in S$ is determined by $\mathcal{O}$
--- more preciesly, by whether $R_1(o_i)$, $R_2(o_i, s)$, $R_2(s, o_i)$ hold in $\A$ for any $o_\bullet \in \mathcal{O}$.

Now take another atom $a' = b'_j$ occurring in $\mathcal{O}(v)$.
What can be said about $R_2(a, a')$?
Except in those happy dispositions where $b'_\bullet = b_\bullet$, not much --- whether $\A \models R_2(o_i, o_j)$ need not be a constraint for $a$ and $a'$.
The index $j$ may not even be unique: we may well have $b'_j = b''_k$ for $j \neq k$.
We want to avoid such confusions:
\begin{definition}
    Let $\mathcal{O}$ be $S$-rigid in $\A^I$,
    and take any $o_\bullet \in \mathcal{O}$.
    We say a finite family $\{ b^{(k)}_\bullet \in \mathcal{O} \mid k \in K\}$ is
    \begin{enumerate}
        \item 
        \emph{unambiguous} if $\sqrt{-} : b^{(k)}_i \mapsto o_i$ for $k \in K$ is a function --- i.e., if $i = i'$ whenever $b^{(k)}_i = b^{(k')}_{i'}$;

        \item 
        \emph{unobstructed} if it is well-indexed and for any $b^{(k)}_i, b^{(k')}_{i'}$, 
        either they are unrelated (in $\A$) or 
        \begin{align*}
            \A \models{} & R(b^{(k)}_i, b^{(k')}_{i'}) \leftrightarrow R(\sqrt{ b^{(k)}_i }, \sqrt{ b^{(k')}_{i'} }) \\
            &{} \wedge R(b^{(k')}_{i'}, b^{(k)}_i) \leftrightarrow R(\sqrt{ b^{(k')}_{i'} }, \sqrt{ b^{(k)}_i })
        \end{align*}
        for every binary relation $R \in \mathcal{L}_0$.\footnote{Of course, whether the family is unambiguous or unobstructed does not depend on the choice of the specific representative $o_\bullet \in \mathcal{O}$!}
    \end{enumerate}
\end{definition}

We can now state the precise result.
\begin{theorem}\label{thm:cog-span-special-case}
    Let $v \in \Ker_\EE \mathcal{O}$ be such that $\mathcal{O}(v)$ is unobstructed.
    Then (assuming that $\mathcal{L}_0$ is at most binary) we have
    \[
        v = \sum_{k \in K} v(b^{(k)}_\bullet) \cdot x^{(k)}_\bullet \between y^{(k)}_\bullet
    \]
    for some $b^{(k)}_\bullet$'s, $x^{(k)}_\bullet$'s, and $y^{(k)}_\bullet$'s, where moreover
    \[
        \mathcal{O}(v) \cup \{ x^{(k)}_\bullet, y^{(k)}_\bullet \mid k \in K \}
    \]
    is also unobstructed.
\end{theorem}



We spend the rest of this subsection giving the proof,
which proceeds by induction on $|I|$ for $S$-rigid orbits $\mathcal{O} \subseteq \A^I$ for every $S$ at once.

The base case $I = \emptyset$ is immediate:
as $\mathcal{O}$ is the singleton $\{ () \}$,
any vector $v \in \Ker_\EE \mathcal{O} = \Lin_\EE \mathcal{O} = \Cog_\EE \mathcal{O}$ is a cog already, where $\mathcal{O}(v)$ is vacuously unobstructed;
so the theorem says nothing more than $v = v$.

Now suppose that some $i^* \in I$ exists --- in fact, let $i^*$ be maximal.
Consider a vector $v \in \Ker_\EE \mathcal{O}$ with $\mathcal{O}(v)$ being unobstructed.
We can decompose $v$ into finitely many subvectors to write
\[
    v = v^{i^* : a_1} + \dots + v^{i^* : a_m}.
\]
Then each projection $v^{i^* : a_j}|^{-i^*}$ lies in $\Ker_\EE \mathcal{O}^{i^* : a_j}|^{-i^*}$ by Lemma~\ref{lem:balanced-projected-subvector},
and we may straightforwardly check that \textit{a fortiori} $\mathcal{O}^{i^* : a_j}|^{-i^*}(v^{i^* : a_j}|^{-i^*})$ is unambiguous and unobstructed.
It follows from the inductive hypothesis of Theorem~\ref{thm:cog-span-special-case} that 
\[
    v^{i^* : a_j}|^{-i^*} 
    = \sum_{k \in K_j} v^{i^* : a_j}|^{-i^*}(b^{(a_j, k)}_\bullet) \cdot x^{(a_j, k)}_\bullet \between y^{(a_j, k)}_\bullet
\]
for some tuples $b^{(a_j, k)}_\bullet$'s,  $x^{(a_j, k)}_\bullet$'s, and $y^{(a_j, k)}_\bullet$'s such that
$\mathcal{O}^{i^* : a_j}|^{-i^*}(v^{i^* : a_j}|^{-i^*}) \cup \{x^{(a_j, k)}_\bullet, y^{(a_j, k)}_\bullet \mid k \in K_j\}$ is unobstructed.
We can return to $\mathcal{O}$ by adding $a_j$ back as the $i^*$th term to every tuple:
we get
\[
    v^{i^* : a_j} 
    = \sum_{k \in K_j} \Bigl( v(b^{(a_j, k)}_\bullet ; a_j) \cdot x^{(a_j, k)}_\bullet \between y^{(a_j, k)}_\bullet \Bigr) ; a_j,
\]
where the family
\[
    \mathcal{O}(v^{i^* : a_j}) \cup \{ (x^{(a_j, k)}_\bullet ; a_j), (y^{(a_j, k)}_\bullet ; a_j) \mid k \in K_j\}
\]
is easily seen to be unobstructed.
We can ask for more:

\begin{claim}\label{claim:half-cog-freshened-up}
    We may choose $x^{(a_j, k)}_\bullet$'s, and $y^{(a_j, k)}_\bullet$'s so that
    \[
        \mathcal{O}(v) \cup \{ (x^{(a_{j'}, k)}_\bullet ; a_{j'}), (y^{(a_{j'}, k)}_\bullet ; a_{j'}) \mid k \in K_{j'}, 1 \leq j' \leq j\}
    \]
    is unobstructed for $j = 1, 2, \dots, m$.
\end{claim}
\begin{proof}
    Let $A_j$ denote the atoms that appear in $\mathcal{O}(v^{i^* : a_j})$.
    Given any automorphism $\pi \in \Aut(\A)$ that fixes $S$ as well as $A_j$, 
    using the tuples $\pi \cdot x^{(a_j, k)}_\bullet$ and $\pi \cdot y^{(a_j, k)}_\bullet$ gives us another decomposition of $v^{i^* : a_j}|^{-i^*}$ that is unobstructed.
    We will show that composing such automorphisms --- which will be provided by Lemma~\ref{lem:free-fresh} --- suffices to make the claim hold for $j$.

    Assume the claim for $j - 1$. 
    Suppose that the family in the claim for $j$ is not even unambiguous.
    We must have $b^{(k)}_i = b^{(k')}_{i'}$ with $i \neq i'$ where $b^{(k)}_\bullet$, say, is some $x^{(a_j, k)}_\bullet ; a_j$ or $y^{(a_j, k)}_\bullet ; a_j$.
    Now if we were to have $b^{(k)}_i \in A_j$ --- e.g., if $b^{(k)}_i = a_j$ --- then $b^{(k)}_i = b^{(k'')}_{i''}$ for some $b^{(k'')}_\bullet \in \mathcal{O}(v^{i^* : a_j}) \subseteq \mathcal{O}(v)$.
    This is impossible: we know two families that are unambiguous which imply $i = i''$ and $i'' = i'$.
    
    So the ambiguous atom $b^{(k)}_i$ does not belong to $A_j$.
    In other words, the set $X$ of all atoms except $b^{(k)}_i$ that appear in $\mathcal{O}(v) \cup \{ (x^{(a_{j'}, k)}_\bullet ; a_{j'}), (y^{(a_{j'}, k)}_\bullet ; a_{j'}) \mid k \in K_{j'}, 1 \leq j' \leq j\}$ contains $A_j$ and $a_j$.
    Apply Lemma~\ref{lem:free-fresh} --- particularly, use the fact that $\A$ has no algebraicity --- to get an automorphism $\tau$ which fixes $S \cup X$ but sends $b^{(k)}_i$ to a fresh atom.
    Then, in the new family 
    \begin{align*}
        \mathcal{O}(v) 
        &\cup \{ (x^{(a_{j'}, k)}_\bullet ; a_{j'}), (y^{(a_{j'}, k)}_\bullet ; a_{j'}) \mid k \in K_{j'}, 1 \leq j' < j\} \\
        &\cup \{ (\tau \cdot x^{(a_{j}, k)}_\bullet ; a_{j}), (\tau \cdot y^{(a_{j}, k)}_\bullet ; a_{j}) \mid k \in K_{j}\}, 
    \end{align*}
    the ambiguous atoms are precisely the ones in the old family minus $b^{(k)}_i$ --- they are all fixed by $\tau$.
    We thus continue this way until all ambiguous atoms are freshened.

    Hence assume that the family in the claim for $j$ is unambiguous.
    Suppose $b^{(k)}_i$ and some $b^{(k')}_{i'}$ are the reason why the family fails to be unobstructed.
    To have the obstruction $b^{(k)}_i$ in $A_j$ is impossible:
    otherwise $b^{(k)}_i = b^{(k'')}_{i''}$ for some $b^{(k'')}_\bullet \in \mathcal{O}(v^{i^* : a_j}) \subseteq \mathcal{O}(v)$;
    then $i = i''$ by the unambiguity assumption, yet $b^{(k'')}_{i''}$ --- hence $b^{(k)}_i$ --- cannot be an obstruction because we have two subfamilies that are unobstructed.
    Symmetrically, we see that $b^{(k')}_{i'} \not\in A_j$.

    Finally, notice that by the claim for $j - 1$, an obstruction $b^{(k)}_i$ must again come from $b^{(k)}_\bullet$ being some $x^{(a_j, k)}_\bullet ; a_j$ or $y^{(a_j, k)}_\bullet ; a_j$.
    This time, split all atoms except $b^{(k)}_i$ which appear in $\mathcal{O}(v) \cup \{ (x^{(a_{j'}, k)}_\bullet ; a_{j'}), (y^{(a_{j'}, k)}_\bullet ; a_{j'}) \mid k \in K_{j'}, 1 \leq j' \leq j \}$ into two sets $X$ and $Y$:
    put any atom $b^{(k')}_{i'}$ which makes $b^{(k)}_i$ an obstruction in $Y$, and put everything else in $X$.
    Then $X$ contains $A_j$ as discussed above;
    in fact, $X$ contains $\{x^{(a_j, k)}_i, y^{(a_j, k)}_i \mid k \in K_j, i \in I\}$.
    Use Lemma~\ref{lem:free-fresh} to get $\tau \in \Aut(\A)_{(S \cup X)}$ which sends $b^{(k)}_i$ to a fresh atom disjoint from $S \cup X \cup Y \cup \{b^{(k)}_i\}$ that is unrelated to everything in $Y$.
    Observe that the new family
    \begin{align*}
        \mathcal{O}(v) 
        &\cup \{ (x^{(a_{j'}, k)}_\bullet ; a_{j'}), (y^{(a_{j'}, k)}_\bullet ; a_{j'}) \mid k \in K_{j'}, 1 \leq j' < j\} \\
        &\cup \{ (\tau \cdot x^{(a_{j}, k)}_\bullet ; a_{j}), (\tau \cdot y^{(a_{j}, k)}_\bullet ; a_{j}) \mid k \in K_{j}\}, 
    \end{align*}
    remains unambiguous.
    Moreover, the obstructions here are precisely the ones from the old family minus $b^{(i)}_k$, which are all fixed by $\tau$.
    So we may repeat this process until all obstructions are removed.
\end{proof}

Having chosen the fresh atoms carefully, let $X$ consist of all the atoms appearing in the unobstructed family $\mathcal{O}(v) \cup \{ (x^{(a_{j'}, k)}_\bullet ; a_{j'}), (y^{(a_{j'}, k)_\bullet} ; a_{j'}) \mid k \in K_{j'}, 1 \leq j' \leq m\}$.
The trick now is to add a new element $b^*$ to the finite $\mathcal{L}$-structure $S \cup X \subseteq \A$. 
We define the new relations in $S \cup X \cup \{b^*\}$ by
\[\left\{
\begin{aligned}
    \cdots \models R_1(b^*) &\iff \A \models R_1(\sqrt{b^*}) \\
    \cdots \models R_2(b^*, s) &\iff \A \models R_2(\sqrt{b^*}, \sqrt s) \\
    \cdots \models R_2(s, b^*) &\iff \A \models R_2(\sqrt s, \sqrt{b^*}) \\
    \cdots \models R_2(b^*, b^{(k)}_i) &\iff \A \models R_2(\sqrt{b^*}, \sqrt{b^{(k)}_i}) \\
    \cdots \models R_2(b^{(k)}_i, b^*) &\iff \A \models R_2(\sqrt{b^{(k)}_i}, \sqrt{b^*}) \\
    \cdots \models b^* > s &\iff \A \models \sqrt{b^*} > \sqrt s \\
    \cdots \models b^* > b^{(k)}_i &
\end{aligned}
\right.\]
for every unary relation $R_1$ and binary relation $R_2$ in $\mathcal{L}_0$,
where we extend $\sqrt{-} : X \to \{o_1, \dots, o_d\}$ to
\[
    \sqrt{-} : S \cup X \cup \{b^*\} \to \{o_1, \dots, o_d\} \cup S
\]
by letting $\sqrt{b^{(k)}_i} = o_i$ as before and $\sqrt{s} = s$, $\sqrt{b^*} = o_{i^*}$ in addition.

So far we only relied on the unambiguity of the family;
next we use the full assumption that it is unobstructed:

\begin{claim}
    $S \cup X \cup \{b^*\}$ embeds into $\A$.
\end{claim}
\begin{proof}
    If not, by Lemma~\ref{lem:free-forb} there is a forbidden $\mathcal{L}_0$-structure $F$ of pairwise related elements which embeds into the $\mathcal{L}_0$-reduct of $S \cup X \cup \{b^*\}$, via $\phi$ say.    
    We will check that $\sqrt{-} \circ \phi$ then embeds $F$ into the $\mathcal{L}_0$-reduct of $\A$, namely $\A_0$, and reach a contradiction.

    So let $R_1 \in \mathcal{L}_0$ be unary and let $R_2 \in \mathcal{L}_0$ be binary.
    It is immediate that $\sqrt -$ preserves and reflects $R_1$ for $s \in S$, for $b^{(k)}_i \in X$, and for $b^*$ --- we do not even need to know they are in the image of $\phi$.
    We can also see that $\sqrt -$ preserves and reflects $R_2$ whenever at least one of the arguments is from $S \cup \{b^*\}$.
    Now consider the remaining case where $b^{(k)}_i = \phi(f)$ and $b^{(k')}_{i'} = \phi(f')$.
    As $f$ and $f'$ are related in $F$, 
    their images $b^{(k)}_i$ and $b^{(k')}_{i'}$ must be related in $\phi(F)$.
    But we ensured that the family giving rise to $X$ is unobstructed, which forces $\sqrt -$ to preserve and reflect $R_2$ here as well.
    Since $\mathcal{L}_0$ only has unary and binary relations, this means that $\sqrt{\phi(F)} \subseteq \A_0$ is in $\mathcal{C}_0$ yet embeds $F$; 
    this is obviously impossible.
\end{proof}

Using homogeneity we may assume that $S \cup X \cup \{b^*\} \subseteq \A$.
\begin{claim}
    $x^{(a_j, k)}_\bullet ; a_j \parallel y^{(a_j, k)}_\bullet ; b^*$ forms an $\mathcal{O}$-cog duo 
    for $1 \leq j \leq m$ and $k \in K_j$.
    Furthermore, the family \[
        \mathcal{O}(v) \cup \{ (x^{(a_j, k)}_\bullet ; a_j),  (y^{(a_j, k)}_\bullet ; b^*) \mid k \in K_j, 1 \leq j \leq m \} 
    \] is unobstructed.
\end{claim}
\begin{proof}
    Recall that $x^{(a_j, k)}_\bullet \parallel y^{(a_j, k)}_\bullet$ is a cog duo in $\mathcal{O}^{i^* : a_j}|^{-i^*}$.
    Given any $o_\bullet \in \mathcal{O}$,
    it remains to show that
    \[
        \A \models R_1(b^*) \leftrightarrow R_1(o_{i^*})
    \]
    for any unary $R_1 \in \mathcal{L}_0$ and that
    \begin{align*}
        \A \models 
        &R_2(b^*, s) \leftrightarrow R_2(o_{i^*}, s) \\
        &\wedge R_2(s, b^*) \leftrightarrow R_2(s, o_{i^*}) \\
        &\wedge R_2(b^*, b^{(k)}_i) \leftrightarrow R_2(o_{i^*}, o_i) \\
        &\wedge R_2(b^{(k)}_i, b^*) \leftrightarrow R_2(o_i, o_{i^*})
    \end{align*}
    for any binary $R_2 \in \mathcal{L}_0$, where $b^{(k)}_\bullet \in \{ x^{(a_j, k)}_\bullet, y^{(a_j, k)}_\bullet \}$ and $s \in S$ are arbitrary.

    Similarly, to show that the family in the claim is unambiguous and unobstructed, it is enough to check pairs of the form $b^*, b^{(k)}_i$ with $b^{(k)}_i \in X$.
    And indeed $b^* \mapsto o_{i^*}, b^{(k)}_i \mapsto o_i$ is always a function, since we chose $b^*$ to be a new element.
    This is furthermore an embedding if $i \neq i^*$ because of the relations we imposed on $b^*$; otherwise $b^*$ is unrelated to $b^{(k)}_{i}$ by irreflexivity, as required.
\end{proof}

\begin{claim}
    We have $v = \sum_{j = 1}^m \sum_{k \in K_j} 
    v(b^{(a_j, k)}_\bullet ; a_j) \cdot
    (x^{(a_j, k)}_\bullet ; a_j \between y^{(a_j, k)}_\bullet ; b^*)$.
\end{claim}
\begin{proof}
    Observe that 
    \begin{align*}
        &\sum_{j=1}^m \sum_{k \in K_j} v(b^{(a_j, k)}_\bullet) \cdot (x^{(a_j, k)}_\bullet ; a_j \between y^{(a_j, k)}_\bullet ; b^*) \\
        ={} &\sum_{j=1}^m \sum_{k \in K_j} \Bigl( v(b^{(a_j, k)}_\bullet) \cdot x^{(a_j, k)}_\bullet \between y^{(a_j, k)}_\bullet \Bigr) ; a_j \\
            &-\sum_{j=1}^m \sum_{k \in K_j} \Bigl( v(b^{(a_j, k)}_\bullet) \cdot x^{(a_j, k)}_\bullet \between y^{(a_j, k)}_\bullet \Bigr) ; b^* \\
        ={}& \sum_{j=1}^m v^{i^*: a_j} - \sum_{j=1}^m v^{i^* : a_j}|^{-i^*} ; b^* \\
        ={}& v - \sum_{j=1}^m v^{i^* : a_j}|^{-i^*} ; b^* ,
    \end{align*}
    so it suffices to show the last sum vanishes.
    Recall from Proposition~\ref{prop:cogs-are-balanced} that cogs are balanced.
    By projecting away the $i^*$th entry, we obtain
    \begin{align*}
        0 
        = 0 - \left( \sum_{j=1}^m v^{i^* : a_j} |^{-i^*} ; b^* \middle) \right|^{-i^*}.
    \end{align*}
    But we can simply add back $b^*$ as the $i^*$th entry,
    yielding $0 = \sum_{j=1}^m v^{i^* : a_j}|^{-i^*} ; b^*$ as needed --- replacing the $i^*$th entry by a common atom achieves the same effect of projecting it away.
\end{proof}

This completes the proof of Theorem~\ref{thm:cog-span-special-case}:
we have shown any balanced vector $v$ is spanned by cogs as long as $\mathcal{O}(v)$ is unambiguous and unobstructed.
Let us lift this restriction.

\subsection{Removing ambiguities and obstructions}

\begin{theorem}\label{thm:cog-span-generally}
    Let $v \in \Ker_\EE \mathcal{O}$ be arbitrary.
    Then (assuming as before that $\mathcal{L}_0$ is at most binary) we have
    \[
        v = \sum_{k \in K} v(b^{(k)}_\bullet) \cdot x^{(k)}_\bullet \between y^{(k)}_\bullet
    \]
    for some $b^{(k)}_\bullet, x^{(k)}_\bullet, y^{(k)}_\bullet \in \mathcal{O}$.
\end{theorem}
As a reminder, $\mathcal{O} \subseteq \A^I$ is an $S$-rigid orbit and $\EE$ is a finite-dimensional $\FF$-vector space.
We induct on $|I|$, noting that when $I = \emptyset$ we are just saying $v = v() \cdot (\between)$.
Hereafter assume $I \neq \emptyset$.

\begin{proposition}\label{prop:bye-ambiguities}
    Let $v \in \Ker_\EE \mathcal{O}$.
    Then we can find $b^{(k)}_\bullet, x^{(k)}_\bullet, y^{(k)}_\bullet \in \mathcal{O}$ so that
    \[
        \ddot v = v - \sum_{k \in K_1} v(b^{(k)}_\bullet) \cdot x^{(k)}_\bullet \between y^{(k)}_\bullet
    \]
    satisfies $\ddot v(\mathcal{O}) = v(\mathcal{O}) \subseteq \EE$ and $\mathcal{O}(\ddot v)$ is unambiguous.
\end{proposition}
\begin{proof}
    Assume there is an ambiguity in $\mathcal{O}(v)$, i.e., there are $a_\bullet, a'_\bullet \in \mathcal{O}(v)$ such that $a_i = a'_{i'}$ but $i \neq i'$ (so $|I| \geq 2$).
    Let us prevent the atom-index pair $(a_i, i)$ from causing ambiguities.
    By Lemma~\ref{lem:balanced-projected-subvector}, the projected subvector $v^{i : a_i} |^{-i}$ belongs to $\Ker_\EE \mathcal{O}^{i : a_i} |^{-i}$;
    by the inductive hypothesis of Theorem~\ref{thm:cog-span-generally} at hand, we have
    \[
        v^{i : a_i} =
        v^{i : a_i}|^{-i} ; a_i = 
        \sum_{k \in K} v(b^{(k)}_\bullet ; a_i) \cdot ( x^{(k)}_\bullet \between y^{(k)}_\bullet ) ; a_i.
    \]
    We can invoke Lemma~\ref{lem:free-fresh} to find an automorphism $\tau$ which fixes all of the atoms except $a_i$ that appear in $x^{(k)}_\bullet, y^{(k)}_\bullet$, $k \in K$ and in $b_\bullet \in \mathcal{O}(v)$.
    It follows from the appropriate modification of Lemma~\ref{lem:cog-fresh-single} that we get $\mathcal{O}$-cog duos $x^{(k)}_\bullet ; a_i \parallel y^{(k)}_\bullet ; \tau \cdot a_i$ for $k \in K$.
    Observe that
    \begin{align*}
        v^{i:a_i} &- \sum_{k \in K} v(b^{(k)}_\bullet ; a_i) \cdot ( x^{(k)}_\bullet ; a_i \between y^{(k)}_\bullet ; \tau \cdot a_i ) \\
        = v^{i:a_i} &- \sum_{k \in K} v(b^{(k)}_\bullet ; a_i) \cdot ( x^{(k)}_\bullet \between y^{(k)}_\bullet ) ; a_i \\
        &+ \sum_{k \in K_1} v(b^{(k)}_\bullet ; a_i) \cdot ( x^{(k)}_\bullet \between y^{(k)}_\bullet ) ; \tau \cdot a_i
    \end{align*}
    is equal to $v^{i:a_i} |^{-i} ; \tau \cdot a_i$, so
    \begin{align*}
        v' 
        &= v - \sum_{k \in K} v(b^{(k)}_\bullet ; a_i) \cdot ( x^{(k)}_\bullet ; \tau \cdot a_i \between y^{(k)}_\bullet ; a_i ) \\
        &= v - v^{i:a_i} + v^{i:a_i} |^{-i} ; \tau \cdot a_i
    \end{align*}
    is the vector obtained by changing the $i$th entry in every tuple of $v$ from $a_i$ to $\tau \cdot a_i$, a fresh atom disjoint from all atoms present.
    Then $v'(\mathcal{O}) = v(\mathcal{O})$.
    Moreover, we can directly check that an ambiguous atom-index pair $(b_j, j)$ in $\mathcal{O}(v')$ cannot be $(\tau \cdot a_i, i)$,
    and hence it must already be one in $\mathcal{O}(v)$ except it cannot be $(a_i, i)$.
    Therefore we may remove all ambiguities by iterating this process.
\end{proof}

Next we tackle the obstructions.
\begin{proposition}\label{prop:bye-obstructions}
    Let $\ddot v \in \Ker_\EE \mathcal{O}$ be such that $\mathcal{O}(\ddot v)$ is unambiguous.
    Then we can find $b^{(k)}_\bullet, x^{(k)}_\bullet, y^{(k)}_\bullet \in \mathcal{O}$ so that
    \[
        \acute{\ddot v} = \ddot v - \sum_{k \in K_2} \ddot v(b^{(k)}_\bullet) \cdot x^{(k)}_\bullet \between y^{(k)}_\bullet    
    \]
    satisfies $\acute{\ddot v}(\mathcal{O}) = \ddot v(\mathcal{O})$ and $\mathcal{O}(\acute{\ddot v})$ is unobstructed.
\end{proposition}
\begin{proof}
    We follow the same strategy:
    let the atom $a_i$ be an obstruction with some other $a'_{i'}$ in $\mathcal{O}(\ddot v)$.
    Consider the projected subvector $\ddot v^{i:a_i}|^{-i}$.
    By Lemma~\ref{lem:balanced-projected-subvector} and the inductive hypothesis of Theorem~\ref{thm:cog-span-generally}, we can write
    \[
        \ddot{v}^{i:a_i} = \sum_{k \in K} \ddot v(b^{(k)}_\bullet ; a_i) \cdot (x^{(k)}_\bullet \between y^{(k)}_\bullet) ; a_i.
    \]
    Leveraging no algebraicity like we did at the beginning of the proof of Claim~\ref{claim:half-cog-freshened-up}, 
    we may assume that $\mathcal{O}(\ddot v) \cup \{ (x^{(k)}_\bullet ; a_i), (y^{(k)}_\bullet ; a_i) \mid k \in K \}$ is unambiguous.
    
    Split the atoms except $a_i$ appearing in that family into two parts $X$ and $Y$, 
    where $Y$ consists of all the atoms equal to some $a'_{i'}$ that make $a_i$ an obstruction.
    Then $x^{(k)}_{i''}$, $y^{(k)}_{i''}$ cannot belong to $Y$ for any $i'' \in I$.
    Indeed, if say $x^{(k)}_{i''}$ is equal to an obstructive atom $a'_{i'}$, we must have $i'' = i'$ by unambiguity; 
    we now have a contradiction: $a'_{i'} = x^{(k)}_{i''}$ and $a_i$ necessarily satisfy the right binary relations, since $x^{(k)}_\bullet ; a_i \in \mathcal{O}$.

    Next, we invoke the Lemma~\ref{lem:free-fresh} to find an automorphism $\tau \cdot \Aut(\A)$ making $\tau \cdot a_i$ greater than $a_i$, distinct from any $x \in X$, and unrelated to any $y \in Y$.
    By Lemma~\ref{lem:cog-fresh-single}, we have $\mathcal{O}$-cog duos $x^{(k)}_\bullet ; a_i \parallel y^{(k)}_\bullet ; \tau \cdot a_i$ for $k \in K$.
    The refined vector
    \begin{align*}
        \ddot v' &= \ddot v - \sum_{k \in K} \ddot v(b^{(k)}_\bullet ; a_i) \cdot (x^{(k)}_\bullet ; \tau \cdot a_i \between y^{(k)}_\bullet ; a_i ) \\
        &= \ddot v - \ddot v^{i : a_i} + \ddot v^{i : \tau \cdot a_i}
    \end{align*}
    satisfies $\ddot v'(\mathcal{O}) = \ddot v(\mathcal{O})$. 
    As we are just changing $a_i$ to the fresh atom $\tau \cdot a_i$ in the $i$th entry of every tuple appearing in $\ddot v$,
    the family $\mathcal{O}(\ddot v')$ remains unambiguous;
    note also that $a_i$ can only appear in the $i$th entry as $\mathcal{O}(\ddot v)$ is unambiguous, 
    so we have completely removed $a_i$ from $\ddot v'$.
    But $\tau \cdot a_i$ by design cannot cause an obstruction in $\mathcal{O}(\ddot v')$,
    and consequently any atom causing obstructions in $\mathcal{O}(\ddot v')$ must already do so in $\mathcal{O}(\ddot v)$ except that it cannot be $a_i$.
    Hence we can repeat this procedure until all obstructions are excised. 
\end{proof}

We are at last in a position to prove the inductive step of Theorem~\ref{thm:cog-span-generally}.
Given $v \in \Ker_\EE \mathcal{O}$, we apply Propositions~\ref{prop:bye-ambiguities} and \ref{prop:bye-obstructions} to obtain
\[
    \acute{\ddot v} = v - \sum_{k \in K_1 \cup K_2} v(b^{(k)}_\bullet) \cdot x^{(k)}_\bullet \between y^{(k)}_\bullet
\]
where $\acute{\ddot v}(\mathcal{O}) = \ddot v(\mathcal{O}) = v(\mathcal{O})$ and $\mathcal{O}(\acute{\ddot v})$ is unobstructed.
Recalling Proposition~\ref{prop:cogs-are-balanced}, we see that $\acute{\ddot v} \in \Ker_\EE \mathcal{O}$.
The special Theorem~\ref{thm:cog-span-special-case} tells us that $\acute{\ddot v}$ is a sum of $\mathcal{O}$-cogs with coefficients from $\acute{\ddot v}(\mathcal{O}) = v(\mathcal{O})$.
It follows that so is
\[
    v = \acute{\ddot v} + \sum_{k \in K_1 \cup K_2} v(b^{(k)}_\bullet) \cdot x^{(k)}_\bullet \between y^{(k)}_\bullet,
\]
which establishes the general Theorem~\ref{thm:cog-span-generally}.


\subsection{All those equivariant subspaces}
We finish this section with an important corollary of Theorem~\ref{thm:cog-span-generally}.
Let $\mathcal{O}_1 \subseteq \A^{I_1}, \dots, \mathcal{O}_m \subseteq \A^{I_n}$ all be $S$-rigid orbits.
Then $\len(\Lin_\FF(\mathcal{O}_1 \uplus \dots \uplus \mathcal{O}_n)) = 2^{|I_1|} + \dots + 2^{|I_n|}$;
in fact, we know and can characterise all the $\Aut(\A)_{(S)}$-equivariant subspaces of $\Lin_\FF(\mathcal{O}_1 \uplus \dots \uplus \mathcal{O}_n)$.

First we set up some notations.
Consider the $\sum_k 2^{|I_k|}$ projected $S$-rigid orbits $\mathcal{O}_k|^{J}$ for $1 \leq k \leq n, J \subseteq I_k$.
Suppose
\[
    f : \mathcal{O}_k|^J \to \mathcal{O}_{k'}|^{J'}
\]
is an $\Aut(\A)_{(S)}$-equivariant bijection.
Take any $o_\bullet \in \mathcal{O}_k|^J$,
and enumerate its entries as $o_1 < \dots < o_{|J|}$.
Similarly, enumerate the entries of $f(o_\bullet)$ as $o'_1 < \dots < o'_{|J'|}$.
Then $\{o_1, \dots, o_{|J|}\} = \{ o'_1, \dots, o'_{|J'|} \}$ because $\A$ has no algebraicity; 
since the orbits are rigid, we must have $|J| = |J'|$ and $o_1 = o'_1, \dots, o_{|J|} = o'_{|J'|}$.
That is, $f$ must be the obvious function that reindexes a $J$-tuple to a $J'$-tuple
--- and hence we will just write $\breve o_\bullet$ for $f(o_\bullet)$, making $f$ implicit.

Now, let $\mathcal{Q}_{1} = \mathcal{O}_{k_1}|^{J_1}, \dots, \mathcal{Q}_{t} = \mathcal{O}_{k_t}|^{J_t}$ be the distinct $S$-rigid orbits up to $\Aut(\A)_{(S)}$-equivariant bijections,
which we enumerate in such a way that $|J_1| \geq |J_2| \geq \dots \geq |J_t|$.

\begin{definition}
    For $i = 1, \dots, t$, let $P_i$ consist of pairs $(k, J)$ such that $\mathcal{O}_k|^J$ is $\Aut(\A)_{(S)}$-equivariantly isomorphic to $\mathcal{Q}_i$.
    Assemble all $|P_i|$ projections into a single map
    \[
        (-){\restriction_i} : \Lin_\FF(\mathcal{O}_1 \uplus \dots \uplus \mathcal{O}_n) \to \Lin_{\FF^{P_i}} \mathcal{Q}_i.
    \]
    More precisely, $(v_1, \dots, v_n){\restriction_i}(a_\bullet)$ is the $P_i$-tuple whose entry at $(k, J)$ is $v_k|^J(\breve a_\bullet) \in \FF$. 
    It is straightforward to check that $(-){\restriction_i}$ is $\Aut(\A)_{(S)}$-equivariant and linear.
\end{definition}

Let $W \subseteq \Lin_\FF( \mathcal{O}_1 \uplus \dots \uplus \mathcal{O}_n )$ be an $\Aut(\A)_{(S)}$-equivariant subspace.
Using the $t$ finite-dimensional vector spaces $W {\restriction_1} (\mathcal{Q}_1) \subseteq \FF^{P_1}, \dots, W {\restriction_t} (\mathcal{Q}_t) \subseteq \FF^{P_t}$
we define $\widetilde W$, which consists of all vectors $v \in \Lin_\FF( \mathcal{O}_1 \uplus \dots \uplus \mathcal{O}_n )$ such that
\[
    v {\restriction_1} (\mathcal{Q}_1) \subseteq W {\restriction_1} (\mathcal{Q}_1), \dots, v {\restriction_t} (\mathcal{Q}_t) \subseteq W {\restriction_t} (\mathcal{Q}_t).
\]
Then $\widetilde W$ is an $\Aut(\A)_{(S)}$-equivariant subspace that contains $W$.
It turns out these two are equal:

\begin{theorem}
    $\widetilde W \subseteq W$.
\end{theorem}

The key is to consider the following refinement.
Let $K_i \subseteq \Lin_\FF( \mathcal{O}_1 \uplus \dots \uplus \mathcal{O}_n )$ consist of vectors $v$ where 
\[
    v {\restriction_{i+1}} = 0, \dots, v {\restriction_t} = 0.
\]
Then $K_0$ is the zero space, whilst $K_t$ is the whole space.

\begin{claim}
    $\widetilde W \cap K_0 \subseteq W \cap K_0$.
\end{claim}

\begin{claim}
    $(\widetilde W \cap K_{i+1}) {\restriction_{i+1}} \subseteq \Ker_{ W {\restriction_{i+1}} (\mathcal{Q}_{i+1}) } \mathcal{Q}_{i+1}$. 
\end{claim}

$v \in \widetilde W$ but $v {\restriction_1} = 0, \dots, v {\restriction_i} = 0$ 


